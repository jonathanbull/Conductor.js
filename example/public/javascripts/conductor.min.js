if(!conductorContext){window.conductor={};var conductorContext=window.conductor}
!function(e,t){"use strict";t.Kernel=function(){var e=this;return e.routes=[],e.registerRoute=function(t,a){e.routes[t]=a},e.databases={},e.initialiseDatabase=function(a){return new Promise(function(n,s){if("undefined"!=typeof t.dbFactory){var r=new t.dbFactory;r.getDatabase(a).then(function(t){e.databases[a.dbName]=t,n()},s)}else s()})},{createDatabase:e.initialiseDatabase,start:function(){var a=new t.router(e.routes);window.onhashchange=a,a()},getDb:function(t){return"undefined"==typeof t&&1===Object.keys(e.databases).length?e.databases[Object.keys(e.databases)[0]]:e.databases[t]},on:e.registerRoute}}}(jQuery,conductorContext);
!function(e){"use strict";e.router=function(e){var r=this;r.routes=e,r.paramToRegex=/\{[a-zA-Z0-9\-]+\}/g,r.captureParamNames=/\{([a-zA-Z0-9\-]+)\}/g,r.isParameterisedRoute=function(e){return e.indexOf("{")>-1&&e.indexOf("}")>-1},r.getParametersFromRoute=function(e,a){var t=e.replace(r.paramToRegex,"([a-zA-Z0-9\\-]+)").replace(/\//g,"\\/"),o=new RegExp(t,"g"),n=o.exec(a);return n},r.createParamtersArray=function(e,a){var t=e.match(r.captureParamNames),o=[];a=a.slice(1,a.length);for(var n=0,u=t.length;u>n;n++)o[t[n].replace(/{|}/g,"")]=a[n];return o};var a=function(){var e=window.location.hash;if(e)for(var a in r.routes)if(r.isParameterisedRoute(a)){var t=r.getParametersFromRoute(a,e);if(t){r.routes[a](r.createParamtersArray(a,t));break}}else if(a===e){r.routes[a](e);break}};return a}}(conductorContext);
!function(n,e){"use strict";e.dbFactory=function(){var r=this;return r.transformModels=function(){var r=[],t=function(t){for(var o=new e.baseModel(t),i=o.getKeysFromObject(new e.models[t]),s={},u=0,f=i.length;f>u;u++)s[i[u]]="";var a=n.extend({},s,o);r[a.modelName()]=a};for(var o in e.models)t(o);return r},{getDatabase:function(n,t){var o=null;return o="WebSql"===t?new e.WebSQL(n,r.transformModels(),e.mixin):"IndexedDb"===t?new e.indexedDb(n,r.transformModels(),e.mixin):window.indexedDB?new e.indexedDb(n,r.transformModels(),e.mixin):new e.WebSQL(n,r.transformModels(),e.mixin)}}},e.mixin=function(e){e.onSuccess=function(n){"undefined"!=typeof n&&n()},e.onError=function(n,e){"undefined"!=typeof e&&e(!1,n.message)},e.getKeysFromObject=function(e){var r=[];for(var t in e)n.isFunction(e[t])||r.push(t);return r},e.getValuesFromObject=function(r,t){var o=[];for(var i in r)t&&null!==r[i]&&"object"==typeof r[i]?n.merge(o,e.getValuesFromObject(r[i],!0)):n.isFunction(r[i])||o.push(r[i]);return o},e.isLast=function(n,e){return n+1===e},e.isFirst=function(n){return 0===n}}}(jQuery,conductorContext);
!function(e,n){"use strict";n.indexedDb=function(t,r,o){var i=this;return o(i),i.models=r,i.open=function(o){var u=indexedDB.open(t.dbName,t.dbVersion);u.onupgradeneeded=function(t){var o=t.target.result;t.target.transaction.onerror=function(e){i.onError(e)};var u=function(t){o.objectStoreNames.contains(i.models[t].modelName())&&o.deleteObjectStore(i.models[t].modelName());var u=i.getKeysFromObject(i.models[t]),a=null;a="undefined"==typeof u.id?o.createObjectStore(r[t].modelName(),{keyPath:"id",autoIncrement:!0}):o.createObjectStore(r[t].modelName(),{keyPath:"id"}),n.indexes[t]&&e.each(n.indexes[t],function(n,t){"id"!==t&&(e.isArray(t)?a.createIndex(t.toString(),t,{unique:!1}):a.createIndex(t,t,{unique:!1}))}),a.createIndex("id","id",{unique:!0})};if(i.models)for(var a in i.models)u(a)},u.onsuccess=function(e){"undefined"!=typeof o&&o(e.target.result,!1)},u.onerror=function(){i.onError(null,!0)}},i.insertObject=function(e,n){return new Promise(function(t,r){i.open(function(o){var u=i.models[e].createFromObject(n),a=o.transaction([u.modelName()],"readwrite"),c=a.objectStore(u.modelName()),s=c.put(u.clone());s.onsuccess=t,s.onerror=r})})},i.insert=function(n,t){return e.isArray(t)?Promise.all(t.map(function(e){return i.insertObject(n,e)})):i.insertObject(n,t)},i.findOneBy=function(e,n,t){var r=i.getKeysFromObject(n);return 1===r.length&&"id"===r[0]?i.findObjectById(e,n.id):new Promise(function(r,o){i.findBy(e,n,t).then(function(e){r(e&&e[0]?e[0]:null)},o)})},i.findObjectById=function(e,n){return new Promise(function(t,r){var o=i.models[e];"undefined"==typeof o?r():i.open(function(e){var i=e.transaction([o.modelName()]),u=i.objectStore(o.modelName()),a=u.get(n);a.onsuccess=function(){t(a.result?o.createFromObject(a.result):null)},a.onerror=r})})},i.deleteBy=function(e,n){return new Promise(function(t,r){i.findBy(e,n).then(function(e){0===e.length?t():Promise.all(e.map(i.deleteItem)).then(t,r)},r)})},i.deleteItem=function(e){return new Promise(function(n,t){i.open(function(r){var o=r.transaction([e.modelName()],"readwrite"),i=o.objectStore(e.modelName()),u=i.delete(e.id);u.onsuccess=n,u.onerror=t})})},i.reduce=function(n,t,r){{var o=[],u=i.getKeysFromObject(t);i.getValuesFromObject(t)}if(e.map(n,function(n){var r=!0;e.each(u,function(e,o){if("object"==typeof t[o]){var u=t[o];for(var a in u){var c=u[a],s=n[o];if(r=i.reduceOperators[a](s,c),!r)break}}else if(r=n[o]===t[o],!r)return!1}),r&&o.push(n)}),r){var a=Object.keys(r)[0],c=r[a];o.sort(function(e,n){return e[a]<n[a]?"asc"===c?-1:1:e[a]>n[a]?"asc"===c?1:-1:0})}return o},i.reduceOperators={greaterThan:function(e,n){return e>n},greaterThanOrEqual:function(e,n){return e>=n},lessThan:function(e,n){return n>e},lessThanOrEqual:function(e,n){return n>=e}},i.findObjectsByAttributeNoIndex=function(e,n,t){var r=i.models[e];return"undefined"==typeof r?Promise.reject():new Promise(function(e,o){i.open(function(u){var a=u.transaction([r.modelName()]),c=a.objectStore(r.modelName()),s=c.openCursor(),d=[];s.onsuccess=function(){var o=s.result;if(o){var u=o.value;d.push(r.createFromObject(u)),o.continue()}else(n||t)&&(d=i.reduce(d,n,t)),e(d)},s.onerror=o})})},i.findObjectsByAttributeWithIndex=function(e,n,t){var r=i.models[e];return"undefined"==typeof r?Promise.reject():new Promise(function(e,o){i.open(function(u){var a=u.transaction([r.modelName()]),c=a.objectStore(r.modelName()),s=i.getKeysFromObject(n),d=s,f=c.index(d.toString()).openCursor(i.generateIDBKeyRange(n,t),i.getDirection(t)),l=[];f.onsuccess=function(){var n=f.result;if(n){var t=n.value;l.push(r.createFromObject(t)),n.continue()}else e(l)},f.onerror=o})})},i.getDirection=function(e){return"undefined"==typeof e||"asc"===e[Object.keys(e)[0]]?"next":"prev"},i.findBy=function(e,t,r){var o=i.models[e];if("undefined"==typeof o)return Promise.reject();var u=i.getKeysFromObject(t);if(!n.indexes[o.modelName()]||!i.isValidQuery(t))return i.findObjectsByAttributeNoIndex(e,t,r);for(var a=0;a<n.indexes[o.modelName()].length;a++)if(u.toString()===n.indexes[o.modelName()][a].toString())return i.findObjectsByAttributeWithIndex(e,t,r);return i.findObjectsByAttributeNoIndex(e,t,r)},i.indexOperators={greaterThan:function(e){return IDBKeyRange.lowerBound(e,!0)},greaterThanOrEqual:function(e){return IDBKeyRange.lowerBound(e)},lessThan:function(e){return IDBKeyRange.upperBound(e,!0)},lessThanOrEqual:function(e){return IDBKeyRange.upperBound(e)}},i.isValidQuery=function(n){var t=(i.getKeysFromObject(n),i.getValuesFromObject(n));if(1===t.length)return!0;var r=0,o=0;return e.each(t,function(e,n){if("object"!=typeof n)r+=1,o+=1;else{var t=Object.keys(n);(t.indexOf("greaterThanOrEqual")>-1||t.indexOf("greaterThan")>-1)&&(r+=1),(t.indexOf("lessThanOrEqual")>-1||t.indexOf("lessThan")>-1)&&(o+=1)}}),o.length===r.length?!0:r.length!==o.length&&r.length>0&&o.length>0?!1:r.length!==o.length?!0:!0},i.generateIDBKeyRange=function(n){var t=(i.getKeysFromObject(n),i.getValuesFromObject(n)),r=!1,o=!1,u=[],a=[];return e.each(t,function(e,n){if("object"!=typeof n)u.push(n);else{var t=Object.keys(n);t.indexOf("greaterThanOrEqual")>-1?u.push(n.greaterThanOrEqual):t.indexOf("greaterThan")>-1&&(u.push(n.greaterThan),r=!0)}}),e.each(t,function(e,n){if("object"!=typeof n)a.push(n);else{var t=Object.keys(n);t.indexOf("lessThanOrEqual")>-1?a.push(n.lessThanOrEqual):t.indexOf("lessThan")>-1&&(a.push(n.lessThan),o=!0)}}),u.length!==a.length&&u?(u=1===u.length?u[0]:u,IDBKeyRange.lowerBound(u,r)):u.length!==a.length&&a?(a=1===a.length?a[0]:a,IDBKeyRange.upperBound(a,o)):(u=1===u.length?u[0]:u,a=1===a.length?a[0]:a,IDBKeyRange.bound(u,a,r,o))},new Promise(function(e,n){i.open(function(t,r){if(r)n();else{var o={type:"IndexedDb",insert:i.insert,findOneBy:i.findOneBy,findBy:i.findBy,deleteBy:i.deleteBy};e(o)}})})}}(jQuery,conductorContext);
!function(e,n){"use strict";n.WebSQL=function(n,t,r){var o=this;return o.operators={greaterThan:">",greaterThanOrEqual:">=",lessThan:"<",lessThanOrEqual:"<="},r(o),o.models=t,o.generateWhereClause=function(n){var t="",r=o.getKeysFromObject(n);return e.each(r,function(i,a){if(null!==n[a]&&"object"==typeof n[a]){var s=o.getKeysFromObject(n[a]);e.each(s,function(e,n){t=t+(o.isFirst(e)?" WHERE ":"")+a+" "+o.operators[n]+" ? "+(o.isLast(e,s.length)?"":"AND ")})}else t=t+(o.isFirst(i)?" WHERE ":"")+a+" = ? "+(o.isLast(i,r.length)?"":"AND ")}),t},o.generateOrderByClause=function(n){var t="",r=o.getKeysFromObject(n);return e.each(r,function(e,i){t=t+(o.isFirst(e)?" ORDER BY ":"")+i+" "+n[i]+" "+(o.isLast(e,r.length)?"":", ")}),t},o.generateSelectQuery=function(e,n,t){var r="SELECT * FROM "+e.modelName();return n&&(r+=o.generateWhereClause(n)),t&&(r+=o.generateOrderByClause(t)),r},o.generateDeleteQuery=function(e,n){var t="DELETE FROM "+e.modelName();return n&&(t+=o.generateWhereClause(n)),t},o.findOneBy=function(e,n,t){return new Promise(function(r,i){o.findBy(e,n,t).then(function(e){r(e&&e[0]?e[0]:null)},i)})},o.findBy=function(e,n,t){return new Promise(function(r,i){var a=[],s=o.models[e],c=o.generateSelectQuery(s,n,t);n&&(a=o.getValuesFromObject(n,!0));var u=function(e,n){for(var t=[],o=0;o<n.rows.length;o++){var i=n.rows.item(o),a=s.createFromObject(i);t.push(a)}r(t)};o.db.transaction(function(e){e.executeSql(c,a,u)},i)})},o.deleteBy=function(e,n){return new Promise(function(t,r){var i=[],a=o.models[e],s=o.generateDeleteQuery(a,n);n&&(i=o.getValuesFromObject(n)),o.db.transaction(function(e){e.executeSql(s,i,t,r)},r)})},o.insertObject=function(n,t){return new Promise(function(r,i){var a=o.models[n].createFromObject(t),s=o.getKeysFromObject(a),c=o.getValuesFromObject(a),u="INSERT OR REPLACE INTO "+a.modelName()+" (";e.each(s,function(e,n){u=u+n+(o.isLast(e,s.length)?"":",")}),u+=") VALUES (",e.each(s,function(e){u=u+"?"+(o.isLast(e,s.length)?"":",")}),u+=");",o.db.transaction(function(e){e.executeSql(u,c)},i,r)})},o.insert=function(n,t){return e.isArray(t)?Promise.all(t.map(function(e){return o.insertObject(n,e)})):o.insertObject(n,t)},o.createTable=function(n){return new Promise(function(t,r){var i=o.getKeysFromObject(n),a="CREATE TABLE IF NOT EXISTS "+n.modelName()+" (";e.each(i,function(e,n){a="id"===n?a+n+" PRIMARY KEY"+(o.isLast(e,i.length)?"":","):a+n+(o.isLast(e,i.length)?"":",")}),a+=");",o.db.transaction(function(e){e.executeSql(a,[],t,r)})})},o.dropTable=function(e){return new Promise(function(n,t){var r=(o.getKeysFromObject(e),"DROP TABLE IF EXISTS "+e.modelName());o.db.transaction(function(e){e.executeSql(r,[],n,t)})})},new Promise(function(e){o.db=openDatabase(n.dbName,"",n.dbDescription,2097152);var r={type:"WebSQL",insert:o.insert,findOneBy:o.findOneBy,findBy:o.findBy,deleteBy:o.deleteBy};if(o.db.version!=n.dbVersion){var i=0,a=function(){i+=1,Object.keys(o.models).length===i&&(o.db.changeVersion(o.db.version,n.dbVersion),e(r))},s=function(e){o.dropTable(e).then(function(){o.createTable(e).then(a)})};if(o.models)for(var c in o.models)s(t[c])}else e(r)})}}(jQuery,conductorContext);
!function(e,t){"use strict";t.models={},t.indexes={},t.baseModel=function(n){var r=this;return r.getKeysFromObject=function(t){var n=[];for(var r in t)e.isFunction(t[r])||n.push(r);return n},r.getValuesFromObject=function(t){var n=[];for(var r in t)e.isFunction(t[r])||n.push(t[r]);return n},{modelName:function(){return n},createFromObject:function(r){var o=new t.baseModel(n),u=new t.models[n];return u=e.extend({},r,o,u)},clone:function(){for(var e=r.getKeysFromObject(this),t=r.getValuesFromObject(this),n={},o=0,u=t.length;u>o;o++)n[e[o]]=t[o];return n},getKeysFromObject:r.getKeysFromObject}}}(jQuery,conductorContext);